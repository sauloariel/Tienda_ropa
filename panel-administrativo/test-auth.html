<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test de Autenticaci√≥n</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        .debug {
            background: #f0f0f0;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }

        .error {
            background: #ffebee;
            color: #c62828;
        }

        .success {
            background: #e8f5e8;
            color: #2e7d32;
        }
    </style>
</head>

<body>
    <h1>üîç Test de Autenticaci√≥n</h1>

    <div class="debug">
        <h3>Estado del localStorage:</h3>
        <p><strong>authToken:</strong> <span id="token-status"></span></p>
        <p><strong>authUser:</strong> <span id="user-status"></span></p>
        <p><strong>Usuario completo:</strong> <span id="user-data"></span></p>
    </div>

    <div class="debug">
        <h3>Acciones:</h3>
        <button onclick="clearAuth()">üßπ Limpiar Autenticaci√≥n</button>
        <button onclick="checkAuth()">üîÑ Verificar Estado</button>
        <button onclick="testLogin()">üîë Simular Login</button>
    </div>

    <div id="results" class="debug"></div>

    <script>
        function checkAuth() {
            const token = localStorage.getItem('authToken');
            const user = localStorage.getItem('authUser');

            document.getElementById('token-status').textContent = token ? '‚úÖ Presente' : '‚ùå Ausente';
            document.getElementById('user-status').textContent = user ? '‚úÖ Presente' : '‚ùå Ausente';
            document.getElementById('user-data').textContent = user || 'No hay datos';

            const results = document.getElementById('results');
            if (token && user) {
                results.innerHTML = '<div class="success">‚úÖ Usuario autenticado correctamente</div>';
                results.innerHTML += `<div>Token: ${token.substring(0, 20)}...</div>`;
                results.innerHTML += `<div>Usuario: ${user}</div>`;
            } else {
                results.innerHTML = '<div class="error">‚ùå Usuario no autenticado</div>';
            }
        }

        function clearAuth() {
            localStorage.removeItem('authToken');
            localStorage.removeItem('authUser');
            checkAuth();
        }

        function testLogin() {
            // Simular un usuario de prueba
            const testUser = {
                id: 1,
                nombre: 'Usuario Test',
                usuario: 'test',
                rol: 'Admin',
                activo: true
            };

            localStorage.setItem('authToken', 'test-token-123');
            localStorage.setItem('authUser', JSON.stringify(testUser));
            checkAuth();
        }

        // Verificar al cargar la p√°gina
        checkAuth();
    </script>
</body>

</html>